(()=>{var e={};e.id=9834,e.ids=[9834],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},48128:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>u,routeModule:()=>h,tree:()=>c});var s=r(67096),i=r(16132),n=r(37284),a=r.n(n),o=r(32564),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c=["",{children:["listing",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,76249)),"/Users/jlau/Code-2023/cpmarketplace/src/app/listing/[id]/page.js"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,96109)),"/Users/jlau/Code-2023/cpmarketplace/src/app/layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["/Users/jlau/Code-2023/cpmarketplace/src/app/listing/[id]/page.js"],d="/listing/[id]/page",p={require:r,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/listing/[id]/page",pathname:"/listing/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},16666:(e,t,r)=>{Promise.resolve().then(r.bind(r,30375))},30375:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var s=r(30784),i=r(57114),n=r(9885),a=r(21971),o=r.n(a),l=r(99360),c=r.n(l),u=r(33987),d=r.n(u),p=r(43872),h=r(81276),x=r.n(h),g=r(56995),m=r.n(g),f=r(52694),v=r.n(f),j=r(76267),_=r.n(j),y=r(1853),q=r.n(y),P=r(16614),b=r.n(P),S=r(20823),w=r(59105),k=r(99066),E=r(76151),C=r(61522),L=r(30321);r(87344);var A=r(18282),U=r(96106);let I=(0,w.p6)(S.ZP),__WEBPACK_DEFAULT_EXPORT__=()=>{let e=(0,i.useRouter)(),{id:t}=(0,i.useParams)(),[r,a]=(0,n.useState)(null),[l,u]=(0,n.useState)(!0),[h,g]=(0,n.useState)(""),[f,j]=(0,n.useState)(null),[y,P]=(0,n.useState)(!1),[S,w]=(0,n.useState)(!0),[M,B]=(0,n.useState)(!1),[T,$]=(0,n.useState)(!1),[G,R]=(0,n.useState)({isAdmin:!1,isStudent:!1}),{getUser:F,isLoggedIn:Z,isAdmin:J}=(0,A.useAuth)(),[O,W]=(0,n.useState)(0);(0,n.useEffect)(()=>{if(t){let fetchListing=async()=>{u(!0);try{let e=(0,C.JU)(E.db,"listings",t),r=await (0,C.QT)(e);r.exists()?a({id:r.id,...r.data()}):g("Listing not found")}catch(e){g("An error occurred while fetching the listing"),console.error(e)}finally{u(!1)}};fetchListing()}},[t]),(0,n.useEffect)(()=>{let fetchSellerInfo=async()=>{if(r&&r.sellerId){let e=(0,C.JU)(E.db,"users",r.sellerId),t=await (0,C.QT)(e);t.exists()?j(t.data()):console.error("Seller not found")}};fetchSellerInfo()},[r]),(0,n.useEffect)(()=>{let e=F();(0,U.PR)(e.uid).then(r=>{if(!r){R(r),w(!1);return}if(""==r.profileImage&&(r.profileImage=null),""==r.heroImage&&(r.heroImage=null),r.uid=e.uid,Z()){let t=F();t.uid==e.uid?(P(!0),t.emailVerified&&"calpoly.edu"==t.email.split("@").pop()&&!r.isStudent&&fetch(`/api/verify/${e.uid}`,{method:"put"}).catch(e=>{console.error(e),setErrorMessage(e.message)})):J().then(e=>{e&&P(!0)}).catch(e=>{console.error(e),setErrorMessage(e.message)})}let checkAdminStatus=async()=>{let e=await J();B(e)};Z()&&checkAdminStatus(),R(r),w(!1),console.log(r),r.favoriteListings.includes(t)&&$(!0)}).catch(e=>{console.error(e),setErrorMessage(e.message)}),console.log(e.favoriteListings)},[Z,J]);let handleFavorite=async()=>{console.log(G),G.favoriteListings.push(t);let e=(0,C.JU)(E.db,"users",G.uid,"private","favorites");await (0,C.r7)(e,{favoriteListings:G.favoriteListings}),$(!0)},handleUnfavorite=async()=>{console.log(G);let e=G.favoriteListings.indexOf(t);G.favoriteListings.splice(e);let r=(0,C.JU)(E.db,"users",G.uid,"private","favorites");await (0,C.r7)(r,{favoriteListings:G.favoriteListings}),$(!1)};return l?s.jsx(o(),{container:!0,justifyContent:"center",alignItems:"center",style:{height:"100vh"},children:s.jsx(c(),{})}):h?s.jsx(d(),{variant:"h6",color:"error",textAlign:"center",children:h}):r?(0,s.jsxs)(p.Z,{sx:{padding:10},children:[(0,s.jsxs)(x(),{"aria-label":"breadcrumb",children:[s.jsx(m(),{underline:"hover",color:"inherit",href:"/",children:"Home"}),s.jsx(d(),{color:"text.primary",children:r.title})]}),(0,s.jsxs)(v(),{elevation:3,sx:{mt:2,p:2},children:[s.jsx(d(),{variant:"h4",gutterBottom:!0,children:r.title}),r.images&&r.images.length>0&&s.jsx(I,{slideRenderer:({index:e,key:t})=>s.jsx("img",{src:r.images[e],alt:`${r.title} - image ${e+1}`,style:{width:"100%",height:"auto"}},t)}),s.jsx(d(),{variant:"body1",gutterBottom:!0,children:r.description}),(0,s.jsxs)(d(),{variant:"h6",gutterBottom:!0,children:["Price: $",r.price]}),(0,s.jsxs)(d(),{variant:"body2",color:"textSecondary",gutterBottom:!0,children:["Location: ",r.location]}),f&&s.jsx(_(),{sx:{maxWidth:345,cursor:"pointer"},onClick:()=>e.push(`/profile/${f.id}`),children:(0,s.jsxs)(q(),{children:[s.jsx(d(),{gutterBottom:!0,variant:"h5",component:"div",children:f.name}),s.jsx(d(),{variant:"body2",color:"text.secondary",children:f.email})]})}),(0,s.jsxs)(p.Z,{sx:{display:"flex",justifyContent:"space-between",mt:2},children:[s.jsx(b(),{variant:"contained",startIcon:s.jsx(L.Z,{}),onClick:()=>{},children:"View on Map"}),!T&&s.jsx(b(),{variant:"contained",onClick:handleFavorite,children:"Favorite"}),T&&s.jsx(b(),{variant:"contained",onClick:handleUnfavorite,children:"Unfavorite"}),s.jsx(b(),{variant:"outlined",startIcon:s.jsx(k.Z,{}),onClick:()=>{},children:"Share"})]})]})]}):null}},76249:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>a,__esModule:()=>n,default:()=>l});var s=r(95153);let i=(0,s.createProxy)(String.raw`/Users/jlau/Code-2023/cpmarketplace/src/app/listing/[id]/page.js`),{__esModule:n,$$typeof:a}=i,o=i.default,l=o}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[6126,3657,1827,1323,9234,9360,5873,4478,402,2291],()=>__webpack_exec__(48128));module.exports=r})();