(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[966],{96507:function(e,t,a){"use strict";a.d(t,{Z:function(){return b}});var n=a(13428),i=a(20791),o=a(2265),s=a(96593),l=a(69613),u=a(87947),d=a(43381),c=a(95270),p=a(57437);let m=["className","component"];var f=a(25097),h=a(82310),g=a(53469);let v=(0,h.Z)(),x=function(e={}){let{themeId:t,defaultTheme:a,defaultClassName:f="MuiBox-root",generateClassName:h}=e,g=(0,l.ZP)("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(u.Z),v=o.forwardRef(function(e,o){let l=(0,c.Z)(a),u=(0,d.Z)(e),{className:v,component:x="div"}=u,b=(0,i.Z)(u,m);return(0,p.jsx)(g,(0,n.Z)({as:x,ref:o,className:(0,s.Z)(v,h?h(f):f),theme:t&&l[t]||l},b))});return v}({themeId:g.Z,defaultTheme:v,defaultClassName:"MuiBox-root",generateClassName:f.Z.generate});var b=x},21975:function(e,t,a){"use strict";a.d(t,{Z:function(){return k}});var n,i=a(13428),o=a(20791),s=a(2265),l=a(7216),u=a(95600),d=a(33449),c=a(35843),p=a(87927),m=a(71711),f=a(57328),h=a(90923),g=a(50819),v=a(84081),x=a(54379),b=a(59592),w=a(28702),Z=a(26520),y=a(25702);function getFormHelperTextUtilityClasses(e){return(0,y.Z)("MuiFormHelperText",e)}let C=(0,Z.Z)("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var j=a(57437);let U=["children","className","component","disabled","error","filled","focused","margin","required","variant"],useUtilityClasses=e=>{let{classes:t,contained:a,size:n,disabled:i,error:o,filled:s,focused:l,required:d}=e,c={root:["root",i&&"disabled",o&&"error",n&&`size${(0,w.Z)(n)}`,a&&"contained",l&&"focused",s&&"filled",d&&"required"]};return(0,u.Z)(c,getFormHelperTextUtilityClasses,t)},F=(0,c.ZP)("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:a}=e;return[t.root,a.size&&t[`size${(0,w.Z)(a.size)}`],a.contained&&t.contained,a.filled&&t.filled]}})(({theme:e,ownerState:t})=>(0,i.Z)({color:(e.vars||e).palette.text.secondary},e.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${C.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${C.error}`]:{color:(e.vars||e).palette.error.main}},"small"===t.size&&{marginTop:4},t.contained&&{marginLeft:14,marginRight:14})),I=s.forwardRef(function(e,t){let a=(0,p.Z)({props:e,name:"MuiFormHelperText"}),{children:s,className:u,component:d="p"}=a,c=(0,o.Z)(a,U),m=(0,b.Z)(),f=(0,x.Z)({props:a,muiFormControl:m,states:["variant","size","disabled","error","filled","focused","required"]}),h=(0,i.Z)({},a,{component:d,contained:"filled"===f.variant||"outlined"===f.variant,variant:f.variant,size:f.size,disabled:f.disabled,error:f.error,filled:f.filled,focused:f.focused,required:f.required}),g=useUtilityClasses(h);return(0,j.jsx)(F,(0,i.Z)({as:d,ownerState:h,className:(0,l.Z)(g.root,u),ref:t},c,{children:" "===s?n||(n=(0,j.jsx)("span",{className:"notranslate",children:"â€‹"})):s}))});var T=a(10654);function getTextFieldUtilityClass(e){return(0,y.Z)("MuiTextField",e)}(0,Z.Z)("MuiTextField",["root"]);let P=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],A={standard:m.Z,filled:f.Z,outlined:h.Z},TextField_useUtilityClasses=e=>{let{classes:t}=e;return(0,u.Z)({root:["root"]},getTextFieldUtilityClass,t)},R=(0,c.ZP)(v.Z,{name:"MuiTextField",slot:"Root",overridesResolver:(e,t)=>t.root})({}),S=s.forwardRef(function(e,t){let a=(0,p.Z)({props:e,name:"MuiTextField"}),{autoComplete:n,autoFocus:s=!1,children:u,className:c,color:m="primary",defaultValue:f,disabled:h=!1,error:v=!1,FormHelperTextProps:x,fullWidth:b=!1,helperText:w,id:Z,InputLabelProps:y,inputProps:C,InputProps:U,inputRef:F,label:S,maxRows:k,minRows:N,multiline:E=!1,name:M,onBlur:z,onChange:q,onFocus:J,placeholder:O,required:H=!1,rows:_,select:B=!1,SelectProps:$,type:L,value:V,variant:W="outlined"}=a,Q=(0,o.Z)(a,P),D=(0,i.Z)({},a,{autoFocus:s,color:m,disabled:h,error:v,fullWidth:b,multiline:E,required:H,select:B,variant:W}),K=TextField_useUtilityClasses(D),G={};"outlined"===W&&(y&&void 0!==y.shrink&&(G.notched=y.shrink),G.label=S),B&&($&&$.native||(G.id=void 0),G["aria-describedby"]=void 0);let X=(0,d.Z)(Z),Y=w&&X?`${X}-helper-text`:void 0,ee=S&&X?`${X}-label`:void 0,et=A[W],er=(0,j.jsx)(et,(0,i.Z)({"aria-describedby":Y,autoComplete:n,autoFocus:s,defaultValue:f,fullWidth:b,multiline:E,name:M,rows:_,maxRows:k,minRows:N,type:L,value:V,id:X,inputRef:F,onBlur:z,onChange:q,onFocus:J,placeholder:O,inputProps:C},G,U));return(0,j.jsxs)(R,(0,i.Z)({className:(0,l.Z)(K.root,c),disabled:h,error:v,fullWidth:b,ref:t,required:H,color:m,variant:W,ownerState:D},Q,{children:[null!=S&&""!==S&&(0,j.jsx)(g.Z,(0,i.Z)({htmlFor:X,id:ee},y,{children:S})),B?(0,j.jsx)(T.Z,(0,i.Z)({"aria-describedby":Y,id:X,labelId:ee,value:V,input:er},$,{children:u})):er,w&&(0,j.jsx)(I,(0,i.Z)({id:Y},x,{children:w}))]}))});var k=S},43188:function(e,t){"use strict";t.Z="/_next/static/fonts/logo.svg"},32866:function(e,t,a){Promise.resolve().then(a.bind(a,75992))},70148:function(e,t,a){"use strict";a.d(t,{I8:function(){return u},db:function(){return d},tO:function(){return c}});var n=a(20994);a(35073);var i=a(24086),o=a(69584),s=a(53085);let l=(0,n.ZF)({apiKey:"AIzaSyBjEHdFQZFsfN-RGa59n16XO7qQ4dhFsAo",authDomain:"slomarket-ebbd9.firebaseapp.com",projectId:"slomarket-ebbd9",storageBucket:"slomarket-ebbd9.appspot.com",messagingSenderId:"247606192779",appId:"1:247606192779:web:421bdc33c388c5c8e828e",measurementId:"G-E3DPKJ6L5V"}),u=(0,s.v0)(l),d=(0,i.ad)(l),c=(0,o.cF)(l)},35959:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return AuthProvider},useAuth:function(){return useAuth}});var n=a(57437),i=a(2265),o=a(70148),s=a(53085);let l=(0,i.createContext)();function useAuth(){return(0,i.useContext)(l)}function AuthProvider(e){let{children:t}=e,[a,u]=(0,i.useState)(),[d,c]=(0,i.useState)(!0);async function isAdmin(){return await o.I8.currentUser.getIdTokenResult().then(e=>!!e.claims.admin).catch(e=>{throw e})}return(0,i.useEffect)(()=>{let e=o.I8.onAuthStateChanged(e=>{u(e),c(!1)},e=>{console.error("Authentication error:",e),c(!1)});return e},[]),(0,n.jsx)(l.Provider,{value:{currentUser:a,getUser:function(){return o.I8.currentUser},isLoggedIn:function(){return null!==o.I8.currentUser},isAdmin,login:function(e,t){return o.I8.signInWithEmailAndPassword(e,t)},signOut:function(){return o.I8.signOut()},signUp:function(e,t){return(0,s.Xb)(o.I8,e,t)}},children:!d&&t})}},75992:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Signup}});var n=a(57437),i=a(2265),o=a(28874),s=a(29872),l=a(96507),u=a(43226),d=a(67070),c=a(21975),p=a(49050),m=a(24033),f=a(35959),h=a(94145),g=a(53085),v=a(43188);function Signup(){var e,t,a;let[x,b]=(0,i.useState)({email:"",password:"",passwordConfirmation:""}),[w,Z]=(0,i.useState)(),y=(0,m.useRouter)(),{signUp:C}=(0,f.useAuth)();async function handleSignup(e){e.preventDefault();let t=e.currentTarget.reportValidity(),a=new FormData(e.currentTarget),n=a.get("email"),i=a.get("password"),o=a.get("passwordConfirmation");return i!=o?(Z(),b({...x,passwordConfirmation:{error:!0,message:"Your passwords don't match."}})):!t||i.length<6?(Z("Passwords must be at least 6 characters long"),b({...x,passwordConfirmation:{error:!1,message:""}})):await C(n,i).then(async e=>{let t=e.user;await (0,h.r4)(t.uid,t.email).then(async()=>{"calpoly.edu"==t.email.split("@").pop()&&await (0,g.w$)(t).catch(e=>{console.error(e),Z(e.message)}),y.push("/setup")}).catch(e=>{console.error(e),Z(e.message)})}).catch(e=>{console.log(e),Z(e.message)}),!1}function handleChange(e){let{field:t,value:a}=e;b({...x,[t]:a})}return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(o.ZP,{container:!0,component:"main",sx:{height:"100vh"},children:[(0,n.jsx)(o.ZP,{item:!0,xs:12,sm:8,md:5,component:s.Z,elevation:6,square:!0,children:(0,n.jsxs)(l.Z,{sx:{width:.5,margin:"auto",textAlign:"center",height:"100vh"},children:[(0,n.jsx)("img",{src:v.Z,alt:"Logo",style:{width:"300px"}}),(0,n.jsx)(u.Z,{variant:"h5",pb:6,children:(0,n.jsx)("strong",{children:"Sign Up for an account."})}),(0,n.jsxs)("form",{onSubmit:handleSignup,children:[w&&(0,n.jsx)(d.Z,{severity:"error",children:w}),(0,n.jsx)(c.Z,{autoFocus:!0,margin:"dense",id:"email",label:"Email Address",type:"email",name:"email",fullWidth:!0,value:x.email,onChange:e=>handleChange({field:"email",value:e.target.value}),error:null===(e=x.email)||void 0===e?void 0:e.error}),(0,n.jsx)("br",{}),(0,n.jsx)(c.Z,{margin:"dense",id:"password",label:"Password",type:"password",name:"password",fullWidth:!0,value:x.password,onChange:e=>handleChange({field:"password",value:e.target.value})}),(0,n.jsx)("br",{}),(0,n.jsx)(c.Z,{margin:"dense",id:"passwordConfirmation",label:"Password Confirmation",type:"password",name:"passwordConfirmation",fullWidth:!0,value:x.passwordConfirmation,onChange:e=>handleChange({field:"passwordConfirmation",value:e.target.value}),error:null===(t=x.passwordConfirmation)||void 0===t?void 0:t.error,helperText:null===(a=x.passwordConfirmation)||void 0===a?void 0:a.message}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(p.Z,{type:"submit",variant:"contained",color:"primary",style:{marginTop:"20px"},children:"Sign Up"})]})]})}),(0,n.jsx)(o.ZP,{item:!0,xs:!1,sm:4,md:7,sx:{backgroundImage:"url(https://source.unsplash.com/random?wallpapers)",backgroundRepeat:"no-repeat",backgroundColor:e=>"light"===e.palette.mode?e.palette.grey[50]:e.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"}})]})})}},94145:function(e,t,a){"use strict";a.d(t,{Ix:function(){return uploadImage},Nq:function(){return updateUser},PR:function(){return getUser},r4:function(){return createUser}});var n=a(70148),i=a(24086),o=a(69584);async function uploadImage(e,t){if(t.size>5e6)throw Error("Image cannot be more than 5 MB large");if(!/\.(jpeg|jpg|png)$/i.test(t.name))throw Error("Image has an invalid extension. Allowed: jpg, png");let a="".concat(Math.floor(1e8+9e8*Math.random()),".").concat(t.name.split(".").pop()),i="images/".concat(e,"/").concat(a),s=(0,o.iH)(n.tO,i);try{await (0,o.KV)(s,t);let e=await (0,o.Jt)(s);return e}catch(e){throw console.error("Error uploading image:",e),e}}async function createUser(e,t){let a=(0,i.JU)(n.db,"users",e),o=(0,i.JU)(n.db,"users",e,"private","contact"),s=(0,i.JU)(n.db,"users",e,"private","favorites");await (0,i.pl)(a,{isAdmin:!1,isStudent:!1,isVerified:!1,name:"",profileImage:"",heroImage:"",contactInfoVisibility:!1}).catch(e=>{throw e}),await (0,i.pl)(o,{email:t,phoneNumber:"",location:""}).catch(e=>{throw e}),await (0,i.pl)(s,{favoriteListings:[],favoriteUsers:[]}).catch(e=>{throw e})}async function getUser(e){let t=(0,i.JU)(n.db,"users",e),a=(0,i.JU)(n.db,"users",e,"private","contact"),o=(0,i.JU)(n.db,"users",e,"private","favorites"),s=null,l=null,u=null;return(await (0,i.QT)(t).then(e=>{e.exists()&&(s=e.data())}).catch(e=>{throw e}),s)?(await (0,i.QT)(a).then(e=>{e.exists()&&(l=e.data())}).catch(()=>{}),await (0,i.QT)(o).then(e=>{e.exists()&&(u=e.data())}).catch(()=>{}),{...s,...l,...u}):null}async function updateUser(e,t){let{email:a,isVerified:o,isAdmin:s,name:l,phoneNumber:u,location:d,profileImage:c,heroImage:p,isStudent:m,contactInfoVisibility:f,favoriteListings:h,favoriteUsers:g}=t,v={isAdmin:s,isStudent:m,isVerified:o,name:l,profileImage:c,heroImage:p,contactInfoVisibility:f},x={email:a,phoneNumber:u,location:d},b={favoriteListings:h,favoriteUsers:g};Object.keys(v).forEach(e=>void 0===v[e]&&delete v[e]),Object.keys(x).forEach(e=>void 0===x[e]&&delete x[e]),Object.keys(b).forEach(e=>void 0===b[e]&&delete b[e]);let w=(0,i.JU)(n.db,"users",e),Z=(0,i.JU)(n.db,"users",e,"private","contact"),y=(0,i.JU)(n.db,"users",e,"private","favorites");v&&await (0,i.r7)(w,v),x&&await (0,i.r7)(Z,x),b&&await (0,i.r7)(y,b)}},96593:function(e,t,a){"use strict";t.Z=function(){for(var e,t,a=0,n="";a<arguments.length;)(e=arguments[a++])&&(t=function r(e){var t,a,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e){if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(a=r(e[t]))&&(n&&(n+=" "),n+=a);else for(t in e)e[t]&&(n&&(n+=" "),n+=t)}return n}(e))&&(n&&(n+=" "),n+=t);return n}}},function(e){e.O(0,[358,565,978,866,874,599,739,971,472,744],function(){return e(e.s=32866)}),_N_E=e.O()}]);